(this.webpackJsonpadegsame=this.webpackJsonpadegsame||[]).push([[0],{42:function(e,t,a){e.exports=a(70)},47:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(34),c=a.n(r),l=(a(47),a(17)),i=a(40),u=a(41),s=a(35),d=a(12),m=a(10),h=a(11),p=a(4),g=a.n(p),f="http://maal-bc.com/adeegside/api",v=new(function(){function e(){Object(m.a)(this,e),localStorage.getItem("token")?this.authenticated=!0:this.authenticated=!1}return Object(h.a)(e,[{key:"login",value:function(e){localStorage.getItem("token")&&(this.authenticated=!0),e()}},{key:"logout",value:function(e){localStorage.removeItem("token"),this.authenticated=!1,e()}},{key:"isAuthenticated",value:function(){return this.authenticated}}]),e}()),E=function(e){var t=e.component,a=Object(s.a)(e,["component"]);return o.a.createElement(d.b,{render:function(e){return v.isAuthenticated()?o.a.createElement(t,Object.assign({},e,a)):o.a.createElement(d.a,{to:{pathname:"/",state:{from:e.location}}})}})},b=a(18),O=a(15),k=a(13),y=a(16),j=Object(n.createContext)(),C=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(O.a)(this,Object(k.a)(t).call(this,e))).state={products:[],categories:[],messages:[],cart:[],ordered:[{token:localStorage.getItem("token")}]},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(j.Provider,{value:{state:this.state,addCart:function(t){var a=[].concat(Object(b.a)(e.state.cart),[t]);if(!1===e.state.cart.includes(t))e.setState({cart:a});else{var n=e.state.cart.filter((function(e,a){return e!==t}));e.setState({cart:n})}},addOrder:function(t){var a=[].concat(Object(b.a)(e.state.ordered),[t]);!1===e.state.ordered.includes(t)&&e.setState({ordered:a})},removeOrder:function(t){var a=e.state.ordered.filter((function(e,a){return e!==t}));e.setState({ordered:a})},getTotalCart:function(){return e.state.cart.length},getCart:function(){return e.state.cart},getOrder:function(){return e.state.ordered}}},this.props.children)}}]),t}(n.Component),S=a(14),_=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).state={loading:!1,error:!1,payload:[]},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0,error:!1}),g()({method:"post",url:this.props.path,headers:{"content-type":"application/json"},data:{token:localStorage.getItem("token")}}).then((function(t){t.data.invalid&&e.setState({error:!0}),e.setState({payload:t.data,loading:!1})})).catch((function(t){e.setState({error:!0})}))}},{key:"render",value:function(){return this.props.render(this.state)}}]),t}(n.Component),w=function(e){var t=o.a.useContext(j),a=Object(n.useState)([]),r=Object(S.a)(a,2),c=r[0],l=r[1];return e.products.map((function(e){var a="",n="";return console.log(c),c.includes(e.pk_product_id)?(n="red",a="Dhig"):(n="green",a="Qaado"),o.a.createElement("div",{key:e.pk_product_id,className:"product_car"},o.a.createElement("div",{className:"card_image_holder"}),o.a.createElement("div",{className:"productInfo"},o.a.createElement("h3",null,e.product_name)),o.a.createElement("div",{className:"card_footer"},o.a.createElement("button",{onClick:function(){!function(e){t.addCart(e),c.includes(e)?l(c.filter((function(t,a){return t!==e}))):l([].concat(Object(b.a)(c),[e]))}(e.pk_product_id)},style:{background:n}},a)))}))};function x(e){var t=o.a.useContext(j),a=function(e){e.target.checked?t.addOrder(e.target.value):t.removeOrder(e.target.value)};return e.quantity.map((function(e,n){return console.log(t.getOrder()),o.a.createElement("ul",{key:e.id},o.a.createElement("li",null,o.a.createElement("input",{type:"checkbox",value:e.id,onChange:a})," ",e.quantity))}))}function N(e){var t=Object(n.useState)([]),a=Object(S.a)(t,2),r=a[0],c=a[1],l=o.a.useContext(j),i=l.getCart();Object(n.useEffect)((function(){g()({method:"post",url:f+"/fetch_cart_products",headers:{"content-type":"application/json"},data:JSON.stringify(i)}).then((function(e){var t=e.data;c(t),console.log(e.data)})).catch((function(e){console.log(e)}))}),[]);return r.map((function(e,t){return o.a.createElement("div",{key:e.pk_product_id},o.a.createElement("h1",null,e.product_name),o.a.createElement(x,{quantity:e.quantity}),l.getOrder().length>0?o.a.createElement("button",{className:"checkout",onClick:function(){!function(){var e=l.getOrder();g()({method:"post",url:f+"/create_order",headers:{"content-type":"application/json"},data:JSON.stringify(e)}).then((function(e){e.data;console.log(e.data)})).catch((function(e){console.log(e)}))}()}},"Dalbo"):null)}))}var I=function(e){var t=o.a.useContext(j).getCart(),a=Object(n.useState)(!1),r=Object(S.a)(a,2),c=r[0],l=r[1];Object(n.useEffect)((function(){g()({method:"post",url:f+"/is_token_valid",headers:{"content-type":"application/json"},data:{token:localStorage.getItem("token")}}).then((function(t){t.data.valid||v.logout((function(){e.history.push("/login")}))})).catch((function(e){console.log(e)}))}),[]);return c?o.a.createElement("div",null,o.a.createElement(_,{render:function(){return o.a.createElement(N,null)}})):o.a.createElement("div",null,o.a.createElement(_,{path:f+"/fetch_products",render:function(e){return e.loading?o.a.createElement("p",null,"Loading Orders"):e.error?o.a.createElement("p",null,"Error while loading orders \ud83d\ude20"):o.a.createElement(w,{products:e.payload})}}),t.length>0?o.a.createElement("button",{className:"checkout",onClick:function(){l(!0)}},"CheckOut"):null)},A=a(38),D=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(O.a)(this,(e=Object(k.a)(t)).call.apply(e,[this].concat(o)))).state={username:null,password:null},a.handleChange=function(e){e.preventDefault(),a.setState(Object(A.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t=a.state;g()({method:"post",url:"".concat(f,"/customer_login"),headers:{"content-type":"application/json"},data:t}).then((function(e){e.data.valid?(localStorage.setItem("token",e.data.token),v.login((function(){a.props.history.push("/dashboard")}))):console.log(e.data,"invalid login")})).catch((function(e){console.log(e,"Invalid Login")}))},a}return Object(y.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return v.isAuthenticated()?o.a.createElement(d.a,{to:"/dashboard"}):o.a.createElement("div",null,o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("input",{type:"number",name:"phone",onChange:this.handleChange}),o.a.createElement("input",{type:"text",name:"password",onChange:this.handleChange}),o.a.createElement("input",{type:"submit",value:"Login"})))}}]),t}(n.Component),L=a(8),q=function(e){return Object(n.useEffect)((function(){g()({method:"post",url:f+"/is_token_valid",headers:{"content-type":"application/json"},data:{token:localStorage.getItem("token")}}).then((function(t){t.data.valid||v.logout((function(){e.history.push("/login")}))})).catch((function(e){console.log(e)}))}),[]),o.a.createElement("div",null,o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(L.b,{to:"/products"},"Products"))),o.a.createElement("br",null),o.a.createElement("button",{onClick:function(){v.logout((function(){e.history.push("/login")}))}},"Logout"))};function J(){return v.isAuthenticated()?o.a.createElement(d.a,{to:"/dashboard"}):o.a.createElement("div",null,o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(L.b,{to:"/login"},"Login"))))}var B=a(39);function P(e){var t=o.a.useContext(j);return o.a.createElement("div",{className:"header"},o.a.createElement("div",{className:"container"},o.a.createElement("a",{href:"#",id:"bars"},o.a.createElement(B.a,{icon:"bars",style:{width:60,height:60,color:"gray"}})),o.a.createElement("img",{src:f+"/product_image/adeegside.png",alt:"logo",className:"logo"}),o.a.createElement("p",null,t.getTotalCart())))}var T=function(){return l.b.add(i.a,u.a),o.a.createElement(C,null,o.a.createElement("div",{className:"App"},o.a.createElement(d.b,{component:P}),o.a.createElement(d.d,null,o.a.createElement(d.b,{exact:!0,path:"/login",component:D}),o.a.createElement(d.b,{exact:!0,path:"/",component:J}),o.a.createElement(d.b,{exact:!0,path:"/home",component:J}),o.a.createElement(E,{exact:!0,path:"/checkout",component:N}),o.a.createElement(E,{exact:!0,path:"/dashboard",component:q}),o.a.createElement(E,{exact:!0,path:"/products",component:I}),o.a.createElement(d.b,{path:"*",render:function(){return"404 page not found"}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(L.a,null,o.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[42,1,2]]]);
//# sourceMappingURL=main.76b762dc.chunk.js.map